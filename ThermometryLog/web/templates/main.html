{% extends 'base.html' %}

{% block header_content %}
<div style="display: inline-block;">
    <div class="mx-4 btn-toolbar" style="display: inline-flex">
        <form>
            <p style="border-right: 1px solid var(--root-fg); padding-right: 1rem;"><strong>Дата:</strong> <input type="date" value="{{date}}" id="date"></p>
            <script type="text/javascript">
                let date = window.document.getElementById("date");
                let olddate = date.value;
                let isChanged = function(){
                    if(date.value !== olddate){
                        olddate = date.value;
                        return true;
                      };
                      return false;
                };
                date.addEventListener("blur", function(){
                    if(isChanged())
                        pywebview.api.open_url('?date=' + olddate)
                });
            </script>
        </form>
        <button class="btn button btn-sm" type="button" style="margin-left: 1rem; margin-bottom: 1rem;" data-bs-toggle="modal" data-bs-target="#addLogModal">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-circle-fill mr-2" viewBox="0 0 16 16">
                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"/>
            </svg><label class="mx-2">Добавить</label>
        </button>
        <form class="search" style="margin-left: 1rem; margin-bottom: 1rem;" method="get" action="/search">
            <input type="hidden" name="date" value="{{date}}">
            <input name="search" type="text" placeholder="Имя, температура" required>
            <button type="submit"></button>
        </form>
    </div>
    <div class="row">
        <div class="col stat-block stat-block-start">
            Всего записей
            <h1>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-journals" viewBox="0 0 16 16">
                    <path d="M5 0h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2 2 2 0 0 1-2 2H3a2 2 0 0 1-2-2h1a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1H1a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v9a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1H3a2 2 0 0 1 2-2z"/>
                    <path d="M1 6v-.5a.5.5 0 0 1 1 0V6h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V9h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 2.5v.5H.5a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1H2v-.5a.5.5 0 0 0-1 0z"/>
                </svg>
                {{logs|length}}
            </h1>
        </div>
        <div class="col stat-block">
            Средняя температура
            <h1>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-thermometer-half" viewBox="0 0 16 16">
                    <path d="M9.5 12.5a1.5 1.5 0 1 1-2-1.415V6.5a.5.5 0 0 1 1 0v4.585a1.5 1.5 0 0 1 1 1.415z"/>
                    <path d="M5.5 2.5a2.5 2.5 0 0 1 5 0v7.55a3.5 3.5 0 1 1-5 0V2.5zM8 1a1.5 1.5 0 0 0-1.5 1.5v7.987l-.167.15a2.5 2.5 0 1 0 3.333 0l-.166-.15V2.5A1.5 1.5 0 0 0 8 1z"/>
                </svg>
                {{average_temp}}
            </h1>
        </div>
        <div class="col stat-block">
            Максимальная температура
            <h1>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-thermometer-high" viewBox="0 0 16 16">
                    <path d="M9.5 12.5a1.5 1.5 0 1 1-2-1.415V2.5a.5.5 0 0 1 1 0v8.585a1.5 1.5 0 0 1 1 1.415z"/>
                    <path d="M5.5 2.5a2.5 2.5 0 0 1 5 0v7.55a3.5 3.5 0 1 1-5 0V2.5zM8 1a1.5 1.5 0 0 0-1.5 1.5v7.987l-.167.15a2.5 2.5 0 1 0 3.333 0l-.166-.15V2.5A1.5 1.5 0 0 0 8 1z"/>
                </svg>
                {{max_temp}}
            </h1>
        </div>
        <div class="col stat-block stat-block-end">
            Минимальная температура
            <h1>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-thermometer-high" viewBox="0 0 16 16">
                    <path d="M9.5 12.5a1.5 1.5 0 1 1-2-1.415V9.5a.5.5 0 0 1 1 0v1.585a1.5 1.5 0 0 1 1 1.415z"/>
                    <path d="M5.5 2.5a2.5 2.5 0 0 1 5 0v7.55a3.5 3.5 0 1 1-5 0V2.5zM8 1a1.5 1.5 0 0 0-1.5 1.5v7.987l-.167.15a2.5 2.5 0 1 0 3.333 0l-.166-.15V2.5A1.5 1.5 0 0 0 8 1z"/>
                </svg>
                {{min_temp}}
            </h1>
        </div>
    </div>
</div>
{% endblock %}

{% block body %}
<div id="menuButton">
    <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-list" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M2.5 11.5A.5.5 0 0 1 3 11h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4A.5.5 0 0 1 3 7h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4A.5.5 0 0 1 3 3h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"/>
    </svg>
</div>
<div id="menu" class="p-3">
    <div class="mb-1" data-bs-toggle="modal" data-bs-target="#importLogsModal" onclick="pywebview.api.import_logs();">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-journal-arrow-down" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M8 5a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 1 1 .708-.708L7.5 9.293V5.5A.5.5 0 0 1 8 5z"/>
            <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"/>
            <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"/>
        </svg>
        Импортировать
    </div>
    <div data-bs-toggle="modal" data-bs-target="#exportLogsModal">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-journal-arrow-up" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M8 11a.5.5 0 0 0 .5-.5V6.707l1.146 1.147a.5.5 0 0 0 .708-.708l-2-2a.5.5 0 0 0-.708 0l-2 2a.5.5 0 1 0 .708.708L7.5 6.707V10.5a.5.5 0 0 0 .5.5z"/>
            <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"/>
            <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"/>
        </svg>
        Экспортировать
    </div>
    <hr>
    <div>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear" viewBox="0 0 16 16">
            <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/>
            <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>
        </svg>
        Настройки
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function(){
        $('#menuButton').click(function() {
            if ($('#menu').css('display') == 'none') {
                $('#menu').fadeIn();
                $('#menuButton').css('background', 'var(--scrollbar-track-color)');
                $('#menuButton').css('border-radius', '5px 5px 0px 0px');
            } else {
                $('#menu').fadeOut();
                $('#menuButton').css('background', '');
                $('#menuButton').css('border-radius', '');
            };
        });
   });
</script>
<div class="px-3" id="main">
    {% if logs|length > 0 %}
    <table class="table table-hover">
        <thead>
            <tr>
                <th scope="col"><strong>Дата измерения</strong></th>
                <th scope="col"><strong>ФИО человека</strong></th>
                <th scope="col"><strong>Температура</strong></th>
            </tr>
        </thead>
        <tbody>
            {% for log in logs %}
            <tr>
                <td>
                    <div class="btn-group">
                        <button type="button" class="btn btn-sm btn-outline" data-log-id="{{log.id}}" data-bs-toggle="modal" data-bs-target="#deleteLogModal">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash2-fill" viewBox="0 0 16 16">
                                <path d="M2.037 3.225A.703.703 0 0 1 2 3c0-1.105 2.686-2 6-2s6 .895 6 2a.702.702 0 0 1-.037.225l-1.684 10.104A2 2 0 0 1 10.305 15H5.694a2 2 0 0 1-1.973-1.671L2.037 3.225zm9.89-.69C10.966 2.214 9.578 2 8 2c-1.58 0-2.968.215-3.926.534-.477.16-.795.327-.975.466.18.14.498.307.975.466C5.032 3.786 6.42 4 8 4s2.967-.215 3.926-.534c.477-.16.795-.327.975-.466-.18-.14-.498-.307-.975-.466z"/>
                            </svg>
                        </button>
                        <button type="button" class="btn btn-sm btn-outline" data-name="{{log.name}}" data-temp="{{log.temperature}}" data-log-id="{{log.id}}" data-bs-toggle="modal" data-bs-target="#editLogModal">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-fill" viewBox="0 0 16 16">
                                <path d="M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z"/>
                            </svg>
                        </button>
                    </div>
                    {{log.date}}
                </td>
                <td>{{log.name}}</td>
                <td>
                    {% if log.temperature <= 36 %}
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-thermometer-low" viewBox="0 0 16 16">
                        <path d="M9.5 12.5a1.5 1.5 0 1 1-2-1.415V9.5a.5.5 0 0 1 1 0v1.585a1.5 1.5 0 0 1 1 1.415z"/>
                        <path d="M5.5 2.5a2.5 2.5 0 0 1 5 0v7.55a3.5 3.5 0 1 1-5 0V2.5zM8 1a1.5 1.5 0 0 0-1.5 1.5v7.987l-.167.15a2.5 2.5 0 1 0 3.333 0l-.166-.15V2.5A1.5 1.5 0 0 0 8 1z"/>
                    </svg>
                    {% elif log.temperature <= 37 %}
                    <svg id="temp-icon${log[0]}" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-thermometer-half" viewBox="0 0 16 16">
                        <path d="M9.5 12.5a1.5 1.5 0 1 1-2-1.415V6.5a.5.5 0 0 1 1 0v4.585a1.5 1.5 0 0 1 1 1.415z"/>
                        <path d="M5.5 2.5a2.5 2.5 0 0 1 5 0v7.55a3.5 3.5 0 1 1-5 0V2.5zM8 1a1.5 1.5 0 0 0-1.5 1.5v7.987l-.167.15a2.5 2.5 0 1 0 3.333 0l-.166-.15V2.5A1.5 1.5 0 0 0 8 1z"/>
                    </svg>
                    {% else %}
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-thermometer-high" viewBox="0 0 16 16">
                        <path d="M9.5 12.5a1.5 1.5 0 1 1-2-1.415V2.5a.5.5 0 0 1 1 0v8.585a1.5 1.5 0 0 1 1 1.415z"/>
                        <path d="M5.5 2.5a2.5 2.5 0 0 1 5 0v7.55a3.5 3.5 0 1 1-5 0V2.5zM8 1a1.5 1.5 0 0 0-1.5 1.5v7.987l-.167.15a2.5 2.5 0 1 0 3.333 0l-.166-.15V2.5A1.5 1.5 0 0 0 8 1z"/>
                    </svg>
                    {% endif %}
                    {{log.temperature}}
                    <div class="progress" style="height: 5px">
                        <div class="progress-bar" role="progressbar"
                             style="width: {{(log.temperature - 30) * 10}}%;background-color:
                             {% if log.temperature|float() <= 35.2 %} var(--temp-color-352)
                             {% elif log.temperature|float() >= 38.0 %} var(--temp-color-380)
                             {% else %} var(--temp-color-{{log.temperature|int()}}{{(log.temperature % 1 * 10)|round()|int()}}, var(--temp-color-{{(log.temperature + 0.1)|int()}}{{((log.temperature + 0.1) % 1 * 10)|round()|int()}}))
                             {% endif %}"
                             aria-valuenow="{{(log.temperature - 30) * 10}}" aria-valuemin="32" aria-valuemax="40">
                        </div>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="container text-center ">
        <h1 class="mt-5">
            Нет записей на это число
            <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" fill="currentColor" class="bi bi-journal" viewBox="0 0 16 16">
                <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"/>
                <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"/>
            </svg>
        </h1>
        <div class="d-grid gap-2 col-6 mx-auto">
            {% if date != now_date %}
            <button type="button" class="btn button" onclick="pywebview.api.open_url('')">Перейти к сегодняшнему числу</button>
            {% endif %}
            <button class="btn button" type="button" data-bs-toggle="modal" data-bs-target="#addLogModal">Добавить запись</button>
        </div>
    </div>
    {% endif %}
</div>

<div class="modal fade" id="deleteLogModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content" style="background: var(--root-bg)">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteLogModalLabel">Удалить запись?</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="deleteModalBody">
                Запись будет не возможно восстановить.
            </div>
            <div class="modal-footer">
                <form id="deleteForm" data-log-id="" method="get">
                    <input type="hidden" name="date" value="{{date}}"/>
                    <button type="button" class="btn btn-success" data-bs-dismiss="modal">Отмена</button>
                    <button type="submit" class="btn btn-danger" id="deleteLogModalBtn">Удалить
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="editLogModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content" style="background: var(--root-bg)">
            <div class="modal-header">
                <h5 class="modal-title" id="editLogModalLabel">Редактирование записи</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="editForm" data-log-id="" onsubmit="" method="get">
                <input type="hidden" name="date" value="{{date}}"/>
                <div class="modal-body" id="editModalBody">
                    <div class="mb-3">
                        <label for="nameInput" class="form-label">ФИО человека</label>
                        <input type="text" class="form-control" id="nameInput" required>
                    </div>
                    <div class="mb-3">
                        <label for="tempInput" class="form-label">Температура</label>
                        <input type="number" class="form-control" id="tempInput" step="0.1" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                    <button type="submit" class="btn btn-success" id="editLogModalBtn">Сохранить
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
<div class="modal fade" id="addLogModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content" style="background: var(--root-bg)">
            <div class="modal-header">
                <h5 class="modal-title" id="addLogModalLabel">Создание новой записи</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="addForm" method="get">
                <input type="hidden" name="date" value="{{date}}"/>
                <div class="modal-body" id="addModalBody">
                    <div class="mb-3">
                        <label for="nameInput" class="form-label">ФИО человека</label>
                        <input type="text" class="form-control" id="newNameInput" required>
                    </div>
                    <div class="mb-3">
                        <label for="tempInput" class="form-label">Температура</label>
                        <input type="number" class="form-control" id="newTempInput" value="36.6" step="0.1" required>
                    </div>
                    <div class="mb-3">
                        <label for="tempInput" class="form-label">Дата</label>
                        <input type="date" class="form-control" id="newDateInput" value="{{date}}" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                    <button type="submit" class="btn btn-success" id="addLogModalBtn">Добавить</button>
                </div>
            </form>
        </div>
    </div>
</div>
<div class="modal fade" id="importLogsModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content" style="background: var(--root-bg)">
            <form id="importLogsForm" method="get">
                <input type="hidden" name="date" value="{{date}}"/>
                <div class="modal-body text-center py-5" id="importLogsModalBody">
                    Выберите файл
                </div>
            </form>
        </div>
    </div>
</div>
<div class="modal fade" id="exportLogsModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content" style="background: var(--root-bg)">
            <form id="exportLogsForm" method="get">
                <input type="hidden" name="date" value="{{date}}"/>
                <div id="exportLogsModalBody">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exportLogsModalLabel">Экспорт записей.</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div>
                            <label for="exportType" class="form-label">Экспорт в:</label>
                            <select id="exportType" class="form-select form-select-lg mb-3" aria-label=".form-select-lg example">
                                <option value="excel" selected>Excel</option>
                                <option value="csv">csv</option>
                            </select>
                        </div>
                        <label for="dateSection" class="form-label">Временные рамки</label>
                        <div id="dateSection" class="btn-toolbar justify-content-center">
                            <p class="mx-2">С <input type="date" value="{{date}}" id="startDate"> </p>
                            <p class="mx-2">До <input type="date" value="{{date}}" id="endDate"> </p>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                        <button type="button" class="btn btn-success" id="exportLogsModalBtn">Продолжить</button>
                        <script type="text/javascript">
                            document.getElementById('exportLogsModalBtn').onclick = function() {
                                let exportType = document.getElementById('exportType').value;
                                let startDate = document.getElementById('startDate').value;
                                let endDate = document.getElementById('endDate').value;
                                if (startDate > endDate) {
                                    alert('Неверные временные рамки.');
                                } else {
                                    pywebview.api.export_logs(exportType, [startDate, endDate]);
                                };
                            };
                        </script>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<script type="text/javascript">
    let deleteLogModal = document.getElementById('deleteLogModal');
    let deleteForm = document.getElementById('deleteForm');
    deleteLogModal.addEventListener('show.bs.modal', function (event) {
        let targetButton = event.relatedTarget;
        deleteForm.dataset.logId = targetButton.dataset.logId;
    });
    deleteForm.addEventListener('submit', function(event){
        let deleteModalBody = document.getElementById('deleteModalBody');
        let html = `
        <div class="d-flex justify-content-center" style="margin: 25% 25% 25% 25%;">
            <div class="spinner-border" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
        `;
        deleteModalBody.innerHTML = html;
        pywebview.api.delete_log(this.dataset.logId);
    });
</script>
<script type="text/javascript">
    let editLogModal = document.getElementById('editLogModal');
    let editForm = document.getElementById('editForm');
    let nameInput = document.getElementById('nameInput');
    let tempInput = document.getElementById('tempInput');
    editLogModal.addEventListener('show.bs.modal', function (event) {
        let targetButton = event.relatedTarget;
        editForm.dataset.logId = targetButton.dataset.logId;
        nameInput.value = targetButton.dataset.name;
        tempInput.value = targetButton.dataset.temp;
    });
    editForm.addEventListener('submit', function(event){
        let editModalBody = document.getElementById('editModalBody');
        let html = `
        <div class="d-flex justify-content-center" style="margin: 25% 25% 25% 25%;">
            <div class="spinner-border" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
        `;
        editModalBody.innerHTML  = html;
        pywebview.api.edit_log(this.dataset.logId, nameInput.value, tempInput.value);
    });
</script>
<script type="text/javascript">
    let addLogModal = document.getElementById('addLogModal');
    let addForm = document.getElementById('addForm');
    let newNameInput = document.getElementById('newNameInput');
    let newTempInput = document.getElementById('newTempInput');
    let newDateInput = document.getElementById('newDateInput');
    addForm.addEventListener('submit', function(event){
        let addModalBody = document.getElementById('addModalBody');
        let html = `
        <div class="d-flex justify-content-center" style="margin: 25% 25% 25% 25%;">
            <div class="spinner-border" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
        `;
        addModalBody.innerHTML  = html;
        pywebview.api.add_log(newNameInput.value, newTempInput.value, newDateInput.value);
    });
</script>
{% endblock %}